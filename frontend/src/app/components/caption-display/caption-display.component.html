<div class="caption-container">
  <!-- Loading State -->
  @if (isLoading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Generating caption...</p>
    </div>
  }

  <!-- Error State -->
  @if (error() && !isLoading()) {
    <div class="error-state">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <p>{{ error() }}</p>
    </div>
  }

  <!-- Caption Display -->
  @if (caption() && !isLoading() && !error()) {
    <div class="caption-result">
      <div class="caption-card">
        <div class="caption-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
          </svg>
        </div>
        <h3>Generated Caption</h3>
        <p class="caption-text">{{ caption() }}</p>
      </div>
    </div>
  }

  <!-- Caption History -->
  @if (captionHistory().length > 0) {
    <div class="history-section">
      <div class="history-header">
        <h4>Recent Captions</h4>
        <button (click)="clearHistory()" class="clear-history-btn">Clear</button>
      </div>
      <div class="history-list">
        @for (item of captionHistory(); track item.timestamp) {
          <div class="history-item">
            <span class="history-number">{{ $index + 1 }}</span>
            <p class="history-caption">{{ item.caption }}</p>
            <span class="history-time">{{ item.timestamp | date:'short' }}</span>
          </div>
        }
      </div>
    </div>
  }
</div>
